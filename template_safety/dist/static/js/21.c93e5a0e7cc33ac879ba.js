webpackJsonp([21],{BO1k:function(e,t,a){e.exports={default:a("fxRn"),__esModule:!0}},L3qu:function(e,t){},"Ub/c":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAADR0lEQVRYR8WXz2sTURDH59vdhFQLUaz2UrAU8Q+wPUmFgBdjbLtLCcWD16pXtSoFbVWwqPWqVo8ePLRll7QhBxGDihfFqz+R9qhWarGlG3aTkbduQtImu29jwXfdmfl+3ryd92ZAkiuRSMTi8XgSwDARHSSiPUTUAaBERD+ZeZmI3gOYtSwrm8vlCjKhEWSUTCb3xmKx68x8CsDOIHvxnZnXATy2LOtqLpf74efTECCRSKjxePw8gCuywpuFBAgz31hdXb2bz+edeiB1AVKp1O5IJLIA4LDMjoNsmPm1bdsnstnsymbbLQBDQ0PdxWLxGYCuoMBhvjPzoqIoR+fm5r5W+9UA9Pf3t6uq+paI9ocJHsJ2yXGc3vn5efHDuqsCkE6nWx3HeUVEh0IEbMb0naqqfTMzMxs1ALquTxLR5WYihvVh5knTNMcqALqu7yOiJSKK1QvGzNdcY2BcRkzC3ioWi12ZTOabewSapk0DGGkkbprmhPim6/odIroQADFlGMaoF3eiETQzPzRN8zTS6XTUcZxfRNTaAGDCNE03AxIQFXEPYByAC19nbaiqugu6rh8jolzArkYNw5gKgKgR13VdZEpkzG8loWnaPQBnJc7WD6IZcSH5QAA8B5CQABAm9SCofObeEcns3JVj5rwA+AhAvG6yqwai2kky7RUXZv4kAMTLtUNW3bPbAhFW3MvAuvgJfxNRWxgAUefl0iz7aZrWsOR8Yq+JDHwGcCAEQM0Pt+kIZO6J6iP4IgBeADgiCbClzoVfiHuiRoaZX4ojuE9EZyQA/EpN5p6oJzGNwcHB4y0tLdkAAJk6Dw1RKpVS7lVs2/aKTyXIiJf5w0D8vYqFZ4jHSOaSqUAEVMYjwzBGXICBgYEORVEW/Z5jAGsSd3slE8zc5vN8W6LrMgzje6Uj0jTtFoCLEj/jP5sw823TNC+JQDUtmW3boiR7/1nBP0D9lkz4iKZUUZQ3290RV/E0bkrLRqItL5VKT4moezszIdWWlwXFYBKNRjNE1LcdEKEGk7JgT09PpLOz89x/Gc2qd+0NpzeZ+aTsjOgNp08syxprejjdnHpvcEky87B4PZm53RvPmYiWxXgO4AMzzxYKhQXZ8fwPwDS3gMGsoz0AAAAASUVORK5CYII="},fxRn:function(e,t,a){a("+tPU"),a("zQR9"),e.exports=a("g8Ux")},g8Ux:function(e,t,a){var i=a("77Pl"),n=a("3fs2");e.exports=a("FeBl").getIterator=function(e){var t=n(e);if("function"!=typeof t)throw TypeError(e+" is not iterable!");return i(t.call(e))}},tQ4E:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAFIElEQVR4Xu1bXYhbVRCeSbJkKWwpqFTFh74o1hWt61pquuTec8K6uFD/8E1roYtILf5UfRHEl6oPShWr1CLi2j4JKkj1SdYzySXYFNdqaasvikoV6wqCLrKbZO8dOZAtd2+Te5LNTZp073nJw5mZM2fO3DnzzZwgrPGBa3z/EBsg9oCABZRS3yDiiMEwJSHEnUEapdQhRNxj4P0rnU7fmMlk/vbTEdEuAPggjJeZK8lkUliW9ZWfrlAo3Oa67nFETBv490opD/lpVnwCjuNc5brunMkrmLkshFiHiF5gE18DwKiJP5FIjFiW9W2A920A2GviBYA9QojDfrp8Pr+TmY+aeJn5mJTy3oYGmJmZ2ZhMJs9rAmb+AhGP1xPKzCellMeCc47jbHVdd9JwCnPBU9D0RHQdAEwBNI5LiFgul8sHJyYm/gsYbxAAngYA/VtvaMNeCQCfCyF2NGUAAHhOCHHAZNV+mCei7wFgc2yA2APiTyCOAaFB0H8NIuIztm2/0Q9BzqSjUuoMIg4br0EtSCdCADCcSqUy2Wz2pEl4P8wrpQ7oA0XEx23bfqfhNdgPm4laxxgMRW3RfpMXe0C/nVjU+l7kAbWIOex53lQul/s96gVrQAvz+byGvxqZnRkYGHh1bGxsvhNr1YDWwxpoeZ63P5fLqYa3QKlUWr+wsPBPjeAJIYSGqJEPInoBAPb7BNetL0S1MBFp6L0FAD4RQjx4ydEgEZ0GgJv9inietymXy/0a1ab9cnoODRLROQDQ+P/CYOYtUspTsQE6YIHYA3qtIBJ/AnEM6NEgyMwJIppDxCsQ8R7btj/rQEzSFeBu3wKf6qSLmV+XUj4bCoeJaBMAXC2EKLW6+dnZ2YH5+fknAWCcmRuVqLXYbXWaGLPMvKLcvby+7j8w83epVOq1bDb7R6t6EdEGZr51cXGxNDk5WQ41QKvC/fRKqSOI+Eg7Mgy85yqVyuZgX6Cd9SJFg0RUAYCBdhQy8Xqelwvm8yaesPlIDaCUOo+IG9tRyMSbSCRusizrBxNds/ORGiCfz+/TgabZxVuhY2YXAF6UUr7SCp+Jth4cfgARb0in029mMpkFk4DgvOM4I67r3hXSp9N9x32IuD7AqxuefzZYbwkAPhRC/NiqPpq+ptOORCJx1LKsnxsGQSLSkftf/R0j4m7btqdXs6CJp9vXoFKqiIjbdQdZSqnrEBfGCg/wd4c72RzttgFiMBSDoR5rj8efQPexQG89kFjzHqCUOoGIW/3X0dLS0obx8fHlirTpJm1pvulboIt5wH0A8BEApGo7OSyEMD2va2nTfuKm8wDNpJRqKxNsVstCoXC967p3A8BZKeWXzfKthm45EwSAI0KIXxomQqsR3u88kYKhfjRGbIB+PLUodb7IA2rB6f7BwcG3VgOHo1QuKlm6JoiIjyLix6Fw2F8VZuZdUkrjA+SolOykHCJargpPSyl3X3I43MnN1pPddCLUrXpAbIAuWyD2gF4riHTZAXQrrrfgcF8YgJl/AoDf6imr/0ojhHg+OEdEU8y8M2yDiDg3NDT00OjoaNVPVygUMp7nvczMYdlpGREfCwKaYrF4bbVafT+kH3kHIq4z/mOkWCwOVatVXRY3DbZtO4mIHICdpxDxFiMz8zYp5YkA77s6WWmC9ykp5UE/nTY8ALxn4jW+EtMC9DtBALjdcIqRe4BSajsivrQaD3Ac5xrXdafDOtL6sIzvBJuw4GVHEqPBy+5IW9zQmveA/wF/OVhuusECFwAAAABJRU5ErkJggg=="},w36n:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("BO1k"),n=a.n(i),o=null;function s(e,t){plus.io.resolveLocalFileSystemURL("_doc/",function(a){a.getDirectory("camera",{create:!0},function(a){"cameraImg"===e?plus.camera.getCamera().captureImage(function(e){c(e,e.substring(e.lastIndexOf("/")+1,e.length),function(e){plus.io.resolveLocalFileSystemURL(e,function(e){e.file(function(t){var a=new plus.io.FileReader;a.onloadend=function(a){var i=r(a.target.result),n=new File([i],t.name),s="file://"+plus.io.convertLocalFileSystemURL(e.toLocalURL());o&&o("1",n,s)},a.readAsDataURL(t)})},function(e){console.log("读取拍照文件错误："+e.message)})})},function(e){console.log("失败："+e.message),o&&o("0","取消拍照")},{filename:"_doc/camera/",index:1}):"selectImg"===e&&function(e){plus.gallery.pick(function(e){var t=!0,a=!1,i=void 0;try{for(var s,l=n()(e.files);!(t=(s=l.next()).done);t=!0){var u=s.value;c(u,u.substring(u.lastIndexOf("/")+1,u.length),function(e){plus.io.resolveLocalFileSystemURL(e,function(e){e.file(function(t){var a=new plus.io.FileReader;a.onloadend=function(a){var i=r(a.target.result),n=new File([i],t.name),s="file://"+plus.io.convertLocalFileSystemURL(e.toLocalURL());o&&o("1",n,s)},a.readAsDataURL(t)})},function(e){console.log("读取拍照文件错误："+e.message)})})}}catch(e){a=!0,i=e}finally{try{!t&&l.return&&l.return()}finally{if(a)throw i}}},function(e){console.log("取消选择图片"),o&&o("0","取消选择相册")},{filter:"image",multiple:!0,maximum:e,system:!1,onmaxed:function(){console.log("最多只能选择"+e+"张图片")}})}(t)},function(e){console.log('Get directory "camera" failed: '+e.message)})},function(e){console.log('Resolve "_doc/" failed: '+e.message)})}var l=function(e,t,a){o=a,window.plus?s(e,t):document.addEventListener("plusready",s(e),!1)};function r(e){for(var t=e.split(","),a=t[0].match(/:(.*?);/)[1],i=atob(t[1]),n=i.length,o=new Uint8Array(n);n--;)o[n]=i.charCodeAt(n);return new Blob([o],{type:a})}function c(e,t,a){plus.zip.compressImage({src:e,dst:"_doc/"+t,quality:20,overwrite:!0},function(e){var t=e.target;a(t)},function(t){a(e),console.log("Compress error!")})}var u=a("Lkus"),d=a.n(u),A={data:function(){return{showAction:!1,myItemsOnlyImage:[{name:"拍照"},{name:"从相册中选"}],showVideo:!1,selectedMediaNum:0}},props:{attachList:{type:Array},readonly:{type:Boolean},file:{type:String,default:"file"},filePath:{type:String,default:"filePath"},mediaLength:{type:Number,default:3},uploadFilePath:{type:String,require:!0,default:"/safetyPatrol/pictureUpload"},uploadFileOption:{type:String}},methods:{delImg:function(e){this.selectedMediaNum--,this.attachList.splice(e,1)},add:function(){this.showAction=!0},onSelect:function(e){"拍照"==e.name?(this.takePhoto(),this.showAction=!1):"从相册中选"==e.name&&(this.selectAlbum(),this.showAction=!1)},takePhoto:function(){var e=this;l("cameraImg",this.mediaLength-this.selectedMediaNum,function(t,a,i){if("1"==t){e.uploadFile(i);var n={};n[e.file]=a,n[e.filePath]=i,n.isNew=!0,n.state=!1,e.selectedMediaNum>e.mediaLength?plus.nativeUI.toast("多媒体资源超出"+e.mediaLength):e.selectedMediaNum++,e.attachList.push(n)}})},selectAlbum:function(){var e=this;l("selectImg",this.mediaLength-this.selectedMediaNum,function(t,a,i){if("1"==t){e.uploadFile(i);var n={};n[e.file]=a,n[e.filePath]=i,n.isNew=!0,n.state=!1,e.selectedMediaNum>e.mediaLength?plus.nativeUI.toast("多媒体资源超出"+e.mediaLength):e.selectedMediaNum++,e.attachList.push(n)}})},uploadFile:function(e){var t=this,a=d.a.baseUrl+this.uploadFilePath,i=plus.uploader.createUpload(a,{method:"POST",blocksize:204800,priority:100},function(e,a){200===a&&(t.$emit("uploadCallback",e.responseText),t.attachList[t.attachList.length-1].state=!0)});i.addFile(e,{key:"file"}),i.setRequestHeader("X-AUTH-TOKEN",this.$store.state.token),i.addData("type",this.uploadFileOption),i.start()}}},f={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"att_main"},[i("div",{staticClass:"att_num_tip"},[i("span",[e._v("上传附件:")]),e._v(" "),i("span",[e._v(e._s(e.selectedMediaNum)+"/"+e._s(e.mediaLength))])]),e._v(" "),i("div",{staticClass:"att_con"},[e._l(e.attachList,function(t,n){return i("div",{key:n,staticClass:"att_item"},[t[e.filePath]?i("img",{staticClass:"att_img",attrs:{src:t[e.filePath]}}):e._e(),e._v(" "),e.readonly?e._e():i("img",{staticClass:"att_del",attrs:{src:a("Ub/c")},on:{click:function(t){return e.delImg(n)}}})])}),e._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:e.attachList.length<e.mediaLength&&!e.readonly,expression:"attachList.length < mediaLength && !readonly"}],staticClass:"att_item",on:{click:e.add}},[i("img",{staticClass:"att_img",attrs:{src:a("tQ4E")}})])],2),e._v(" "),[i("van-action-sheet",{attrs:{actions:e.myItemsOnlyImage,"cancel-text":"取消"},on:{select:e.onSelect},model:{value:e.showAction,callback:function(t){e.showAction=t},expression:"showAction"}})]],2)},staticRenderFns:[]};var m=a("VU/8")(A,f,!1,function(e){a("L3qu")},"data-v-73ba1d0c",null);t.default=m.exports}});
//# sourceMappingURL=21.c93e5a0e7cc33ac879ba.js.map