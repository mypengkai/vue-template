{"version":3,"sources":["webpack:///src/components/reformConent.vue","webpack:///./src/components/reformConent.vue?45fc","webpack:///./src/components/reformConent.vue","webpack:///./src/api/self.js"],"names":["reformConent","props","components","reformLoop","__webpack_require__","e","then","bind","Attach","inject","data","sendData","id","replayUserId","replayUserName","srId","replayType","replayState","replayContent","filesId","fileList","files","type","methods","getCallback","this","obj","save","_this","list","srUserId","srUserName","srid","length","$toast","reform","getSelf","res","success","reload","components_reformConent","render","_vm","_h","$createElement","_c","_self","staticClass","_l","item","index","key","attrs","label","spContent","slot","_v","_s","hdGrade","title","srContent","images","src","fileURL","FilePath","value","srFinishDate","loopConent","Reply","$store","state","userID","rows","autosize","placeholder","model","callback","$$v","$set","expression","attachList","readonly","uploadFileOption","on","uploadCallback","size","click","_e","staticRenderFns","Component","normalizeComponent","ssrContext","__webpack_exports__","getSelfList","http","post","selfDeatil","downRectify","uploadFile","addSelf"],"mappings":"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","file":"static/js/36.738a2a71617b804aea47.js","sourcesContent":["<template>\r\n  <div class=\"reformConent\">\r\n    <van-cell-group v-for=\"(item,index) in list\" :key=\"index\">\r\n      <van-cell :label=\"item.spContent\">\r\n        <template slot=\"title\">\r\n          <span class=\"custom-title\">安全隐患</span>\r\n          <van-tag type=\"danger\">{{item.hdGrade}}</van-tag>\r\n        </template>\r\n      </van-cell>\r\n      <van-cell title=\"整改要求\" :label=\"item.srContent\"></van-cell>\r\n      <van-cell title=\"附件\">\r\n          <template slot=\"label\">\r\n             <span>\r\n                <viewer :images=\"item.files\">\r\n                  <img v-for=\"(src,index) in item.files\" :src=\"fileURL+src.FilePath\" :key=\"index\" />\r\n                </viewer>\r\n              </span>\r\n          </template>\r\n      </van-cell>\r\n      <van-cell title=\"整改完成时间\" :value=\"item.srFinishDate\" />\r\n      <van-cell title=\"指定整改人\" :value=\"item.srUserName\" />\r\n      <!-- 循环组件 -->\r\n      <reformLoop :loopConent=\"item.Reply\"></reformLoop>\r\n\r\n      <div v-if=\"$store.state.userID==item.srUserId && item.type==0\">\r\n        <van-cell-group>\r\n          <van-cell title=\"整改说明\">\r\n            <template slot=\"label\">\r\n              <van-field\r\n                v-model=\"sendData.replayContent\"\r\n                rows=\"2\"\r\n                autosize\r\n                type=\"textarea\"\r\n                placeholder=\"请输入整改内容\"\r\n              />\r\n            </template>\r\n          </van-cell>\r\n        </van-cell-group>\r\n        <!-- <van-uploader\r\n          v-model=\"fileList\"\r\n          capture=\"camera\"\r\n          multiple\r\n          :max-count=\"3\"\r\n          :after-read=\"afterRead\"\r\n          preview-size=\"70\"\r\n        /> -->\r\n        <Attach :attachList=\"fileList.files\" :readonly=\"false\" :uploadFileOption=\"fileList.type\" @uploadCallback=\"getCallback\"></Attach>\r\n        <van-button type=\"info\" size=\"large\" @click=\"save\">提交保存</van-button>\r\n      </div>\r\n    </van-cell-group>\r\n  </div>\r\n</template>\r\n<script>\r\nimport self from \"@/api/self\";\r\nimport reform from \"@/api/reform\";\r\nexport default {\r\n  props: [\"list\", \"subscript\", \"id\"],\r\n  components: {\r\n    reformLoop: () => import(\"./reformLoop.vue\"),\r\n    Attach:()=>import(\"./Attach.vue\")\r\n  },\r\n  inject: [\"reload\"],\r\n  data() {\r\n    return {\r\n      sendData: {\r\n        id: \"\", //安全巡检id\r\n        replayUserId: \"\", // 回复人id\r\n        replayUserName: \"\", // 回复人名称\r\n        srId: \"\", // 整改内容id\r\n        replayType: 0,\r\n        replayState: 0,\r\n        replayContent: \"\", // 整改内容\r\n        filesId: \"\" // 文件id\r\n      },\r\n      fileList: {\r\n        files: [],\r\n        type: \"SafetyPatrol\" // 安全\r\n      }\r\n    };\r\n  },\r\n  methods: {\r\n    // afterRead(file) {\r\n    //   let formData = new FormData();\r\n    //   formData.append(\"type\", this.type);\r\n    //   if (file.length > 0) {\r\n    //     for (let key of file) {\r\n    //       formData.append(\"file\", key.file);\r\n    //     }\r\n    //   } else {\r\n    //     formData.append(\"file\", file.file);\r\n    //   }\r\n    //   self.uploadFile(formData).then(res => {\r\n    //     if (res.data.success == 0) {\r\n    //       this.sendData.filesId = res.data.obj;\r\n    //     }\r\n    //   });\r\n    // },\r\n\r\n    getCallback(data){\r\n         this.sendData.filesId += data.obj + \",\"\r\n    },\r\n    save() {\r\n      this.sendData.id = this.id;\r\n      this.sendData.replayUserId = this.list[0].srUserId;\r\n      this.sendData.replayUserName = this.list[0].srUserName;\r\n      this.sendData.srId = this.list[0].srid;\r\n      if (this.sendData.replayContent.length == 0) {\r\n        this.$toast(\"请输入整改内容\");\r\n        return false;\r\n      }\r\n      reform.getSelf(this.sendData).then(res => {\r\n        if (res.data.success == 0) {\r\n          this.$toast(\"整改成功\");\r\n          this.reload();\r\n        }\r\n      });\r\n    }\r\n  }\r\n};\r\n</script>\r\n<style scoped>\r\n.reformConent {\r\n  height: 100%;\r\n  padding: 0 0.2rem 0.2rem 0.2rem;\r\n}\r\n.van-cell {\r\n  position: relative;\r\n  display: -webkit-box;\r\n  display: -webkit-flex;\r\n  display: flex;\r\n  box-sizing: border-box;\r\n  width: 100%;\r\n  padding: 0.2rem 0.2rem 0.2rem 0.5rem;\r\n  overflow: hidden;\r\n  color: #323233;\r\n  font-size: 0.3rem;\r\n  line-height: 0.53333rem;\r\n  background-color: #fff;\r\n}\r\n.van-cell__value {\r\n  position: relative;\r\n  overflow: hidden;\r\n  color: #1989fa;\r\n  text-align: left;\r\n  vertical-align: middle;\r\n}\r\n\r\nimg {\r\n  width: 1.2rem;\r\n  height: 1.2rem;\r\n  margin: 0 0.1rem;\r\n}\r\n.van-cell-group {\r\n  background-color: #fff;\r\n  margin-bottom: 0.2rem;\r\n}\r\n.van-cell__label {\r\n  margin-top: 3px;\r\n  color: #1989fa;\r\n  font-size: 12px;\r\n  line-height: 18px;\r\n}\r\n.van-uploader {\r\n  position: relative;\r\n  display: inline-block;\r\n  margin-left: 0.5rem;\r\n}\r\n</style>\n\n\n// WEBPACK FOOTER //\n// src/components/reformConent.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"reformConent\"},_vm._l((_vm.list),function(item,index){return _c('van-cell-group',{key:index},[_c('van-cell',{attrs:{\"label\":item.spContent}},[_c('template',{slot:\"title\"},[_c('span',{staticClass:\"custom-title\"},[_vm._v(\"安全隐患\")]),_vm._v(\" \"),_c('van-tag',{attrs:{\"type\":\"danger\"}},[_vm._v(_vm._s(item.hdGrade))])],1)],2),_vm._v(\" \"),_c('van-cell',{attrs:{\"title\":\"整改要求\",\"label\":item.srContent}}),_vm._v(\" \"),_c('van-cell',{attrs:{\"title\":\"附件\"}},[_c('template',{slot:\"label\"},[_c('span',[_c('viewer',{attrs:{\"images\":item.files}},_vm._l((item.files),function(src,index){return _c('img',{key:index,attrs:{\"src\":_vm.fileURL+src.FilePath}})}),0)],1)])],2),_vm._v(\" \"),_c('van-cell',{attrs:{\"title\":\"整改完成时间\",\"value\":item.srFinishDate}}),_vm._v(\" \"),_c('van-cell',{attrs:{\"title\":\"指定整改人\",\"value\":item.srUserName}}),_vm._v(\" \"),_c('reformLoop',{attrs:{\"loopConent\":item.Reply}}),_vm._v(\" \"),(_vm.$store.state.userID==item.srUserId && item.type==0)?_c('div',[_c('van-cell-group',[_c('van-cell',{attrs:{\"title\":\"整改说明\"}},[_c('template',{slot:\"label\"},[_c('van-field',{attrs:{\"rows\":\"2\",\"autosize\":\"\",\"type\":\"textarea\",\"placeholder\":\"请输入整改内容\"},model:{value:(_vm.sendData.replayContent),callback:function ($$v) {_vm.$set(_vm.sendData, \"replayContent\", $$v)},expression:\"sendData.replayContent\"}})],1)],2)],1),_vm._v(\" \"),_c('Attach',{attrs:{\"attachList\":_vm.fileList.files,\"readonly\":false,\"uploadFileOption\":_vm.fileList.type},on:{\"uploadCallback\":_vm.getCallback}}),_vm._v(\" \"),_c('van-button',{attrs:{\"type\":\"info\",\"size\":\"large\"},on:{\"click\":_vm.save}},[_vm._v(\"提交保存\")])],1):_vm._e()],1)}),1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-9ffec784\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/reformConent.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-9ffec784\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!../../node_modules/vue-loader/lib/selector?type=styles&index=0!./reformConent.vue\")\n}\nvar normalizeComponent = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./reformConent.vue\"\nimport __vue_script__ from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./reformConent.vue\"\n/* template */\nimport __vue_template__ from \"!!../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-9ffec784\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../node_modules/vue-loader/lib/selector?type=template&index=0!./reformConent.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-9ffec784\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/reformConent.vue\n// module id = null\n// module chunks = ","\r\nimport http from \"./request\"\r\nexport default {\r\n      // 自检查询\r\n    getSelfList(data){\r\n        return http.post(\"/NewSafetyPatrolController/searchList\",data)\r\n    },\r\n    // 自检明细\r\n    selfDeatil(data){\r\n        return http.post(\"/NewSafetyPatrolController/searchOne\",data)\r\n    },\r\n    //下发整改单\r\n    downRectify(data){\r\n        return http.post(\"/SafetyRectification/appointRectification\",data)\r\n    },\r\n    //文件上传\r\n    uploadFile(data){\r\n        return http.post(\"/safetyPatrol/pictureUpload\",data)\r\n    },\r\n    //自检新增\r\n    addSelf(data){\r\n        return http.post(\"/NewSafetyPatrolController/add\",data)\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/api/self.js"],"sourceRoot":""}