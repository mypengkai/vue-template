{"version":3,"sources":["webpack:///./node_modules/babel-runtime/core-js/get-iterator.js","webpack:///./src/assets/del.png","webpack:///./node_modules/core-js/library/fn/get-iterator.js","webpack:///./node_modules/core-js/library/modules/core.get-iterator.js","webpack:///./src/assets/tianjia.png","webpack:///./src/units/camera.js","webpack:///src/components/Attach.vue","webpack:///./src/components/Attach.vue?9825","webpack:///./src/components/Attach.vue"],"names":["module","exports","default","__webpack_require__","__esModule","anObject","get","getIterator","it","iterFn","TypeError","call","back","cameraPlusReady","type","mediaNum","plus","io","resolveLocalFileSystemURL","entry","getDirectory","create","dir","camera","getCamera","captureImage","p","compressImage","substring","lastIndexOf","length","res","file","reader","FileReader","onloadend","e","blob","dataURLtoBlob","target","result","newfile","File","name","path","convertLocalFileSystemURL","toLocalURL","readAsDataURL","console","log","message","filename","index","gallery","pick","_iteratorNormalCompletion","_didIteratorError","_iteratorError","undefined","_step","_iterator","get_iterator_default","files","next","done","value","err","return","filter","multiple","maximum","system","onmaxed","getImage","openCamera","callback","window","document","addEventListener","dataurl","arr","split","mime","match","bstr","atob","n","u8arr","Uint8Array","charCodeAt","Blob","src","fileName","cb","zip","dst","quality","overwrite","event","error","task","Attach","data","showAction","myItemsOnlyImage","showVideo","selectedMediaNum","props","attachList","Array","readonly","Boolean","String","filePath","mediaLength","Number","uploadFilePath","require","uploadFileOption","methods","delImg","this","splice","add","onSelect","item","takePhoto","selectAlbum","_this","state","uploadFile","newFile","nativeUI","toast","push","_this2","_this3","url","baseUrl_default","a","baseUrl","uploader","createUpload","method","blocksize","priority","upload","status","$emit","responseText","addFile","key","setRequestHeader","$store","token","addData","start","components_Attach","render","_vm","_h","$createElement","_c","_self","staticClass","_v","_s","_l","attrs","_e","on","click","$event","directives","rawName","expression","actions","cancel-text","select","model","$$v","staticRenderFns","Component","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"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","file":"static/js/21.725eb766603dc700f246.js","sourcesContent":["module.exports = { \"default\": require(\"core-js/library/fn/get-iterator\"), __esModule: true };\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/babel-runtime/core-js/get-iterator.js\n// module id = BO1k\n// module chunks = 0 21","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAADR0lEQVRYR8WXz2sTURDH59vdhFQLUaz2UrAU8Q+wPUmFgBdjbLtLCcWD16pXtSoFbVWwqPWqVo8ePLRll7QhBxGDihfFqz+R9qhWarGlG3aTkbduQtImu29jwXfdmfl+3ryd92ZAkiuRSMTi8XgSwDARHSSiPUTUAaBERD+ZeZmI3gOYtSwrm8vlCjKhEWSUTCb3xmKx68x8CsDOIHvxnZnXATy2LOtqLpf74efTECCRSKjxePw8gCuywpuFBAgz31hdXb2bz+edeiB1AVKp1O5IJLIA4LDMjoNsmPm1bdsnstnsymbbLQBDQ0PdxWLxGYCuoMBhvjPzoqIoR+fm5r5W+9UA9Pf3t6uq+paI9ocJHsJ2yXGc3vn5efHDuqsCkE6nWx3HeUVEh0IEbMb0naqqfTMzMxs1ALquTxLR5WYihvVh5knTNMcqALqu7yOiJSKK1QvGzNdcY2BcRkzC3ioWi12ZTOabewSapk0DGGkkbprmhPim6/odIroQADFlGMaoF3eiETQzPzRN8zTS6XTUcZxfRNTaAGDCNE03AxIQFXEPYByAC19nbaiqugu6rh8jolzArkYNw5gKgKgR13VdZEpkzG8loWnaPQBnJc7WD6IZcSH5QAA8B5CQABAm9SCofObeEcns3JVj5rwA+AhAvG6yqwai2kky7RUXZv4kAMTLtUNW3bPbAhFW3MvAuvgJfxNRWxgAUefl0iz7aZrWsOR8Yq+JDHwGcCAEQM0Pt+kIZO6J6iP4IgBeADgiCbClzoVfiHuiRoaZX4ojuE9EZyQA/EpN5p6oJzGNwcHB4y0tLdkAAJk6Dw1RKpVS7lVs2/aKTyXIiJf5w0D8vYqFZ4jHSOaSqUAEVMYjwzBGXICBgYEORVEW/Z5jAGsSd3slE8zc5vN8W6LrMgzje6Uj0jTtFoCLEj/jP5sw823TNC+JQDUtmW3boiR7/1nBP0D9lkz4iKZUUZQ3290RV/E0bkrLRqItL5VKT4moezszIdWWlwXFYBKNRjNE1LcdEKEGk7JgT09PpLOz89x/Gc2qd+0NpzeZ+aTsjOgNp08syxprejjdnHpvcEky87B4PZm53RvPmYiWxXgO4AMzzxYKhQXZ8fwPwDS3gMGsoz0AAAAASUVORK5CYII=\"\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/del.png\n// module id = Ub/c\n// module chunks = 21","require('../modules/web.dom.iterable');\nrequire('../modules/es6.string.iterator');\nmodule.exports = require('../modules/core.get-iterator');\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/fn/get-iterator.js\n// module id = fxRn\n// module chunks = 0 21","var anObject = require('./_an-object');\nvar get = require('./core.get-iterator-method');\nmodule.exports = require('./_core').getIterator = function (it) {\n  var iterFn = get(it);\n  if (typeof iterFn != 'function') throw TypeError(it + ' is not iterable!');\n  return anObject(iterFn.call(it));\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/core.get-iterator.js\n// module id = g8Ux\n// module chunks = 0 21","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAFIElEQVR4Xu1bXYhbVRCeSbJkKWwpqFTFh74o1hWt61pquuTec8K6uFD/8E1roYtILf5UfRHEl6oPShWr1CLi2j4JKkj1SdYzySXYFNdqaasvikoV6wqCLrKbZO8dOZAtd2+Te5LNTZp073nJw5mZM2fO3DnzzZwgrPGBa3z/EBsg9oCABZRS3yDiiMEwJSHEnUEapdQhRNxj4P0rnU7fmMlk/vbTEdEuAPggjJeZK8lkUliW9ZWfrlAo3Oa67nFETBv490opD/lpVnwCjuNc5brunMkrmLkshFiHiF5gE18DwKiJP5FIjFiW9W2A920A2GviBYA9QojDfrp8Pr+TmY+aeJn5mJTy3oYGmJmZ2ZhMJs9rAmb+AhGP1xPKzCellMeCc47jbHVdd9JwCnPBU9D0RHQdAEwBNI5LiFgul8sHJyYm/gsYbxAAngYA/VtvaMNeCQCfCyF2NGUAAHhOCHHAZNV+mCei7wFgc2yA2APiTyCOAaFB0H8NIuIztm2/0Q9BzqSjUuoMIg4br0EtSCdCADCcSqUy2Wz2pEl4P8wrpQ7oA0XEx23bfqfhNdgPm4laxxgMRW3RfpMXe0C/nVjU+l7kAbWIOex53lQul/s96gVrQAvz+byGvxqZnRkYGHh1bGxsvhNr1YDWwxpoeZ63P5fLqYa3QKlUWr+wsPBPjeAJIYSGqJEPInoBAPb7BNetL0S1MBFp6L0FAD4RQjx4ydEgEZ0GgJv9inietymXy/0a1ab9cnoODRLROQDQ+P/CYOYtUspTsQE6YIHYA3qtIBJ/AnEM6NEgyMwJIppDxCsQ8R7btj/rQEzSFeBu3wKf6qSLmV+XUj4bCoeJaBMAXC2EKLW6+dnZ2YH5+fknAWCcmRuVqLXYbXWaGLPMvKLcvby+7j8w83epVOq1bDb7R6t6EdEGZr51cXGxNDk5WQ41QKvC/fRKqSOI+Eg7Mgy85yqVyuZgX6Cd9SJFg0RUAYCBdhQy8Xqelwvm8yaesPlIDaCUOo+IG9tRyMSbSCRusizrBxNds/ORGiCfz+/TgabZxVuhY2YXAF6UUr7SCp+Jth4cfgARb0in029mMpkFk4DgvOM4I67r3hXSp9N9x32IuD7AqxuefzZYbwkAPhRC/NiqPpq+ptOORCJx1LKsnxsGQSLSkftf/R0j4m7btqdXs6CJp9vXoFKqiIjbdQdZSqnrEBfGCg/wd4c72RzttgFiMBSDoR5rj8efQPexQG89kFjzHqCUOoGIW/3X0dLS0obx8fHlirTpJm1pvulboIt5wH0A8BEApGo7OSyEMD2va2nTfuKm8wDNpJRqKxNsVstCoXC967p3A8BZKeWXzfKthm45EwSAI0KIXxomQqsR3u88kYKhfjRGbIB+PLUodb7IA2rB6f7BwcG3VgOHo1QuKlm6JoiIjyLix6Fw2F8VZuZdUkrjA+SolOykHCJargpPSyl3X3I43MnN1pPddCLUrXpAbIAuWyD2gF4riHTZAXQrrrfgcF8YgJl/AoDf6imr/0ojhHg+OEdEU8y8M2yDiDg3NDT00OjoaNVPVygUMp7nvczMYdlpGREfCwKaYrF4bbVafT+kH3kHIq4z/mOkWCwOVatVXRY3DbZtO4mIHICdpxDxFiMz8zYp5YkA77s6WWmC9ykp5UE/nTY8ALxn4jW+EtMC9DtBALjdcIqRe4BSajsivrQaD3Ac5xrXdafDOtL6sIzvBJuw4GVHEqPBy+5IW9zQmveA/wF/OVhuusECFwAAAABJRU5ErkJggg==\"\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/tianjia.png\n// module id = tQ4E\n// module chunks = 21","let back = null;\n\n// 拍照\nfunction getCamera() {\n\tlet cmr = plus.camera.getCamera();\n\tcmr.captureImage(function (p) {\n\t\tlet fileName = p.substring(p.lastIndexOf('/') + 1, p.length);\n\t\t//先压缩图片\n\t\tcompressImage(p, fileName, (res) => {\n\t\t\tplus.io.resolveLocalFileSystemURL(res, function (entry) {\n\t\t\t\tentry.file(function (file) {\n\t\t\t\t\tlet reader = new plus.io.FileReader();\n\t\t\t\t\treader.onloadend = function (e) {\n\t\t\t\t\t\tlet blob = dataURLtoBlob(e.target.result);\n\t\t\t\t\t\tlet newfile = new File([blob], file.name);\n\t\t\t\t\t\tlet path = 'file://' + plus.io.convertLocalFileSystemURL(entry.toLocalURL())\n\t\t\t\t\t\tif (back) {\n\t\t\t\t\t\t\tback('1', newfile, path)\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treader.readAsDataURL(file);\n\t\t\t\t})\n\t\t\t}, function (e) {\n\t\t\t\tconsole.log('读取拍照文件错误：' + e.message);\n\t\t\t});\n\t\t})\n\t}, function (e) {\n\t\tconsole.log('失败：' + e.message);\n\t\tif (back) {\n\t\t\tback('0', '取消拍照')\n\t\t}\n\t}, { filename: '_doc/camera/', index: 1 });\n}\n\n//从相册选择图片\nfunction getImage(mediaNum) {\n\tlet cmr = plus.gallery.pick(path => {\n\t\tfor (let p of path.files) {\n\t\t\tlet fileName = p.substring(p.lastIndexOf('/') + 1, p.length);\n\t\t\t//先压缩图片\n\t\t\tcompressImage(p, fileName, (res) => {\n\t\t\t\tplus.io.resolveLocalFileSystemURL(res, function (entry) {\n\t\t\t\t\tentry.file(function (file) {\n\t\t\t\t\t\tlet reader = new plus.io.FileReader();\n\t\t\t\t\t\treader.onloadend = function (e) {\n\t\t\t\t\t\t\tlet blob = dataURLtoBlob(e.target.result);\n\t\t\t\t\t\t\tlet newfile = new File([blob], file.name);\n\t\t\t\t\t\t\tlet path = 'file://' + plus.io.convertLocalFileSystemURL(entry.toLocalURL())\n\t\t\t\t\t\t\tif (back) {\n\t\t\t\t\t\t\t\tback('1', newfile, path)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\treader.readAsDataURL(file);\n\n\t\t\t\t\t})\n\t\t\t\t}, function (e) {\n\t\t\t\t\tconsole.log('读取拍照文件错误：' + e.message);\n\t\t\t\t});\n\t\t\t})\n\t\t}\n\t}, e => {\n\t\tconsole.log('取消选择图片')\n\t\tif (back) {\n\t\t\tback('0', '取消选择相册')\n\t\t}\n\t}, {\n\t\tfilter: \"image\", multiple: true, maximum: mediaNum, system: false, onmaxed: function () {\n\t\t\tconsole.log('最多只能选择' + mediaNum + '张图片')\n\t\t}\n\t})\n}\n\nfunction cameraPlusReady(type, mediaNum) {\n\t// 获取摄像头目录对象\n\tplus.io.resolveLocalFileSystemURL('_doc/', function (entry) {\n\t\tentry.getDirectory('camera', { create: true }, function (dir) {\n\t\t\t if (type === 'cameraImg') {\n\t\t\t\tgetCamera()\n\t\t\t} else if (type === 'selectImg') {\n\t\t\t\tgetImage(mediaNum)\n\t\t\t}\n\t\t}, function (e) {\n\t\t\tconsole.log('Get directory \"camera\" failed: ' + e.message);\n\t\t});\n\t}, function (e) {\n\t\tconsole.log('Resolve \"_doc/\" failed: ' + e.message);\n\t});\n}\n\nexport const openCamera = function (type, mediaNum, callback) {\n\tback = callback;\n\tif (window.plus) {\n\t\tcameraPlusReady(type, mediaNum);\n\t} else {\n\t\tdocument.addEventListener('plusready', cameraPlusReady(type), false);\n\t}\n}\n\n//转换为BLOB对象\nfunction dataURLtoBlob(dataurl) {\n\tvar arr = dataurl.split(','), mime = arr[0].match(/:(.*?);/)[1],\n\t\tbstr = atob(arr[1]), n = bstr.length, u8arr = new Uint8Array(n);\n\twhile (n--) {\n\t\tu8arr[n] = bstr.charCodeAt(n);\n\t}\n\treturn new Blob([u8arr], { type: mime });\n}\n\n//压缩图片\nfunction compressImage(src, fileName, cb) {\n\tplus.zip.compressImage({\n\t\tsrc: src,\n\t\tdst: \"_doc/\" + fileName,\n\t\tquality: 20,\n\t\toverwrite: true\n\t},\n\t\tfunction (event) {\n\t\t\tlet target = event.target; // 压缩转换后的图片url路径，以\"file://\"开头\n\t\t\tcb(target)\n\t\t}, function (error) {\n\t\t\tcb(src)\n\t\t\tconsole.log(\"Compress error!\");\n\t\t});\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/units/camera.js","<template>\n  <div class=\"att_main\">\n    <div class=\"att_num_tip\">\n      <span>上传附件:</span>\n      <span>{{selectedMediaNum}}/{{mediaLength}}</span>\n    </div>\n    <div class=\"att_con\">\n      <div class=\"att_item\" v-for=\"(item, index) in attachList\" :key=\"index\">\n        <img v-if=\"item[filePath]\" class=\"att_img\" :src=\"item[filePath]\" />\n        <img v-if=\"!readonly\" class=\"att_del\" @click=\"delImg(index)\" src=\"@/assets/del.png\" />\n      </div>\n      <div class=\"att_item\" v-show=\"attachList.length < mediaLength && !readonly\" @click=\"add\">\n        <img class=\"att_img\" src=\"@/assets/tianjia.png\" />\n      </div>\n    </div>\n\n    <template>\n      <van-action-sheet\n        :actions=\"myItemsOnlyImage\"\n        v-model=\"showAction\"\n        cancel-text=\"取消\"\n        @select=\"onSelect\"\n      ></van-action-sheet>\n    </template>\n  </div>\n</template>\n\n<script>\nimport { openCamera } from \"@/units/camera\";\nimport getUrl from \"../api/baseUrl\";\nlet task = null;\nexport default {\n  data() {\n    return {\n      showAction: false,\n      myItemsOnlyImage: [{ name: \"拍照\" }, { name: \"从相册中选\" }],\n      showVideo: false,\n      selectedMediaNum: 0,\n      task: \"\"\n    };\n  },\n  props: {\n    attachList: {\n      type: Array\n    },\n    readonly: {\n      type: Boolean\n    },\n    file: {\n      type: String,\n      default: \"file\"\n    },\n    filePath: {\n      type: String,\n      default: \"filePath\"\n    },\n    mediaLength: {\n      type: Number,\n      default: 3\n    },\n    //文件上传路径\n    uploadFilePath: {\n      type: String,\n      require: true,\n      default: \"/safetyPatrol/pictureUpload\"\n    },\n    uploadFileOption: {\n      type: String\n    }\n  },\n  methods: {\n    delImg(index) {\n      this.selectedMediaNum--;\n      this.attachList.splice(index, 1);\n    },\n    add() {\n      this.showAction = true;\n    },\n    onSelect(item) {\n      if (item.name == \"拍照\") {\n        this.takePhoto();\n        this.showAction = false;\n      } else if (item.name == \"从相册中选\") {\n        this.selectAlbum();\n        this.showAction = false;\n      }\n    },\n\n    //拍照\n    takePhoto() {\n      openCamera(\n        \"cameraImg\",\n        this.mediaLength - this.selectedMediaNum,\n        (state, file, path) => {\n          if (state == \"1\") {\n            this.uploadFile(path);\n            let newFile = {};\n            newFile[this.file] = file;\n            newFile[this.filePath] = path;\n            newFile[\"isNew\"] = true;\n            newFile[\"state\"] = false;\n            if (this.selectedMediaNum > this.mediaLength) {\n              plus.nativeUI.toast(\"多媒体资源超出\" + this.mediaLength);\n            } else {\n              this.selectedMediaNum++;\n            }\n            this.attachList.push(newFile);\n          }\n        }\n      );\n    },\n    //从相册中选\n    selectAlbum() {\n      openCamera(\n        \"selectImg\",\n        this.mediaLength - this.selectedMediaNum,\n        (state, file, path) => {\n          if (state == \"1\") {\n            this.uploadFile(path);\n            let newFile = {};\n            newFile[this.file] = file;\n            newFile[this.filePath] = path;\n            newFile[\"isNew\"] = true;\n            newFile[\"state\"] = false;\n            if (this.selectedMediaNum > this.mediaLength) {\n              plus.nativeUI.toast(\"多媒体资源超出\" + this.mediaLength);\n            } else {\n              this.selectedMediaNum++;\n            }\n            this.attachList.push(newFile);\n          }\n        }\n      );\n    },\n    //文件上传\n    uploadFile(path) {\n      //开始上传\n      var url = getUrl.baseUrl + this.uploadFilePath;\n      task = plus.uploader.createUpload(\n        url,\n        { method: \"POST\", blocksize: 204800, priority: 100 },\n        (upload, status) => {\n          if (status === 200) {\n            this.$emit(\"uploadCallback\", upload.responseText);\n            this.attachList[this.attachList.length - 1].state = true;\n          }\n        }\n      );\n      task.addFile(path, { key: \"file\" });\n      // 设置自定义数据头\n      task.setRequestHeader(\"X-AUTH-TOKEN\", this.$store.state.token);\n      task.addData(\"type\", this.uploadFileOption);\n      task.start(); // 开始上传\n    },\n  }\n};\n</script>\n\n<style scoped>\n.att_main {\n  background-color: #fff;\n}\n.att_con {\n  overflow: hidden;\n  padding-top: 10px;\n}\n.att_num_tip {\n  line-height: 20px;\n  font-size: 14px;\n  color: #555555;\n  display: flex;\n  justify-content: space-between;\n  padding: 0 0.4rem;\n}\n.att_item {\n  width: 25%;\n  float: left;\n  text-align: center;\n  position: relative;\n  margin: 0 8px 15px 8px;\n  border-radius: 5px;\n}\n.att_img {\n  width: 65px;\n  height: 65px;\n  margin: 0 auto;\n}\n.att_del {\n  width: 20px;\n  position: absolute;\n  top: -8px;\n  right: 50%;\n  margin-right: -40px;\n  background-color: #fff;\n  border-radius: 20px;\n}\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/components/Attach.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"att_main\"},[_c('div',{staticClass:\"att_num_tip\"},[_c('span',[_vm._v(\"上传附件:\")]),_vm._v(\" \"),_c('span',[_vm._v(_vm._s(_vm.selectedMediaNum)+\"/\"+_vm._s(_vm.mediaLength))])]),_vm._v(\" \"),_c('div',{staticClass:\"att_con\"},[_vm._l((_vm.attachList),function(item,index){return _c('div',{key:index,staticClass:\"att_item\"},[(item[_vm.filePath])?_c('img',{staticClass:\"att_img\",attrs:{\"src\":item[_vm.filePath]}}):_vm._e(),_vm._v(\" \"),(!_vm.readonly)?_c('img',{staticClass:\"att_del\",attrs:{\"src\":require(\"@/assets/del.png\")},on:{\"click\":function($event){return _vm.delImg(index)}}}):_vm._e()])}),_vm._v(\" \"),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.attachList.length < _vm.mediaLength && !_vm.readonly),expression:\"attachList.length < mediaLength && !readonly\"}],staticClass:\"att_item\",on:{\"click\":_vm.add}},[_c('img',{staticClass:\"att_img\",attrs:{\"src\":require(\"@/assets/tianjia.png\")}})])],2),_vm._v(\" \"),[_c('van-action-sheet',{attrs:{\"actions\":_vm.myItemsOnlyImage,\"cancel-text\":\"取消\"},on:{\"select\":_vm.onSelect},model:{value:(_vm.showAction),callback:function ($$v) {_vm.showAction=$$v},expression:\"showAction\"}})]],2)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-4e00aead\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/Attach.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-4e00aead\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!../../node_modules/vue-loader/lib/selector?type=styles&index=0!./Attach.vue\")\n}\nvar normalizeComponent = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./Attach.vue\"\nimport __vue_script__ from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./Attach.vue\"\n/* template */\nimport __vue_template__ from \"!!../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-4e00aead\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../node_modules/vue-loader/lib/selector?type=template&index=0!./Attach.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-4e00aead\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/Attach.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}